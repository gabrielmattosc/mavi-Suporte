{% extends "base.html" %}

{% block title %}Detalhes do Ticket #{{ ticket.ticket_id }}{% endblock %}

{% block content %}
<div class="container fade-in">
    <h1><i class="fas fa-ticket-alt"></i> Detalhes do Ticket #{{ ticket.ticket_id }}</h1>

    <div class="card mt-4">
        <div class="card-header">
            Informações do Ticket
        </div>
        <div class="card-body">
            <p><strong>Solicitante:</strong> {{ ticket.nome }}</p>
            <p><strong>Email:</strong> {{ ticket.email }}</p>
            <p><strong>Status:</strong> <span class="status-badge status-{{ ticket.status.lower().replace(' ', '-') }}">{{ ticket.status }}</span></p>
            <p><strong>Prioridade:</strong> <span class="status-badge priority-{{ ticket.prioridade.lower() }}">{{ ticket.prioridade }}</span></p>
            <p><strong>Categoria:</strong> {{ ticket.categoria }}</p>
            <p><strong>Data de Criação:</strong> {{ ticket.data_criacao.strftime('%d/%m/%Y %H:%M') }}</p>
            <p><strong>Descrição:</strong></p>
            <p>{{ ticket.descricao }}</p>
        </div>
    </div>

    <div class="card mt-4">
        <div class="card-header">
            Atualizar Status
        </div>
        <div class="card-body">
            <form method="POST" action="{{ url_for('admin.update_status') }}">
                <input type="hidden" name="ticket_id" value="{{ ticket.ticket_id }}">
                <div class="form-group">
                    <label for="status_select">Novo Status</label>
                    <select name="status" id="status_select" class="form-control" required>
                        <option value="" disabled selected>Selecione</option>
                        <option value="Pendente">Pendente</option>
                        <option value="Em andamento">Em andamento</option>
                        <option value="Concluída">Concluída</option>
                    </select>
                </div>
                <div class="form-group mt-3">
                    <label for="observacao_input">Observação</label>
                    <textarea name="observacao" id="observacao_input" class="form-control" rows="3"></textarea>
                </div>
                <div class="mt-3">
                    <button type="submit" class="btn btn-primary">Atualizar</button>
                    <a href="{{ url_for('admin.index') }}" class="btn btn-secondary">Voltar</a>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}